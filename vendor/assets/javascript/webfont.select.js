!function($){var t;return t={},$.widget("webfont.wfselect",{options:{fonts:{google:{families:[{name:"Droid Sans",url:null},{name:"Signika",url:null}],url_generation:{base_url:"https://fonts.googleapis.com/css?family=$font",space_char:"+"}}},merge_list:!1},_create:function(){var t,e,n,i;n=this,e=this.options,t=this.element,i=e.fonts||this.options.fonts,t.addClass("webfont-input").wrap($("<div/>").addClass("webfont-wrapper")),t.on("keyup paste",{instance:n},n._searchFontList),this.wrapper=t.closest(".webfont-wrappers"),t.after(n._createFontList(i,this.options.merge_list).hide()),n._selectFontByName(t.val()),n.toggle=$("<div/>").addClass("ui-icon ui-icon-triangle-1-s").insertAfter(t),n._bindHandlers()},_createFontList:function(t,e){var n,i;return null==e&&(e=!1),this.fontList=$("<ul/>").addClass("webfont-list"),i=this,n=this._createFontObjects(t,e),$.each(n,function(t,e){$("<li/>").html(e.font).data("font_name",e.font).data("font_type",e.type).data("font_url",e.url).css(i._fontToStyle(e.font)).appendTo(i.fontList)}),this.fontList},_searchFontList:function(t){var e,n,i,o;o=t.data.instance,e=$(this).val(),i=o.options.fonts,n=$.extend(!0,{},i),$.each(n,function(t,i){var s;s=i.families,n[t].families=s.filter(o._filterFontList,e)}),o.element.nextAll().remove(),o.element.after(o._createFontList(n,o.options.merge_list)),o._bindHandlers()},_filterFontList:function(t){return"string"==typeof t?t.toLowerCase().indexOf(this.toString().toLowerCase())>=0:t.name.toLowerCase().indexOf(this.toString().toLowerCase())>=0},_createFontObjects:function(t,e){var n,i;return null==e&&(e=!1),n=[],i=this,$.each(t,function(e,o){var s;s=o.families.map(function(n){return"string"==typeof n?{font:n,type:e,url:i._generateFontUrl(t,e,n)}:{font:n.name,type:e,url:n.url||i._generateFontUrl(t,e,n.name)}}),n=n.concat(s)}),e&&(n=n.sort(function(t,e){return t.font>e.font})),n},_generateFontUrl:function(t,e,n){return void 0===t[e].url_generation?null:(void 0!==t[e].url_generation.space_char&&(n=n.split(" ").join(t[e].url_generation.space_char)),t[e].url_generation.base_url.replace("$font",n))},_fontToStyle:function(t){var e;return e=t.split(":"),{"font-family":this._readableFontName(e[0]),"font-weight":e[1]||400}},_readableFontName:function(t){return t.replace(/[\+|:]/g," ")},_selectFontByName:function(t){var e,n;return e=this.fontList.find("li"),n=$.grep(e,function(e,n){return $(e).data("font_name")===t}),!!n.length&&(this._selectFontListItem($(n).first()),!0)},_selectFontListItem:function(t){var e,n,i,o;return t.hasClass("selected")?null:(this.fontList.find("li.selected").removeClass("selected"),t=$(t).addClass("selected"),e=t.data("font_name"),n=t.data("font_type"),i=t.data("font_url"),o=this._fontToStyle(e),this.element.css(o),this.element.val()!==e&&this.element.val(e).attr("font_url",i).trigger("change"),this._trigger("change",null,o),this._loadFonts([{font:e,type:n}]),void this._toggleFontList(!1))},_loadFonts:function(e){var n,i;return n=$.grep(e,function(n){return t[e.font]},!0),n.length?(i={},$.each(n,function(e,n){t[n.font]=!0,Object.keys(i).indexOf(n.type)===-1&&(i[n.type]={}),Object.keys(i[n.type]).indexOf("families")===-1&&(i[n.type].families=[]),i[n.type].families.push(n.font)}),void WebFont.load(i)):null},_loadVisibleFonts:function(){var t,e,n,i,o,s;return this.fontList.is(":visible")?(s=this,o=this.fontList.scrollTop(),i=this.fontList.height(),n=o+i,t=this.fontList.find("li"),e=[],$.each(t,function(t,n){var o,s;n=$(n),s=n.position().top,o=s+n.outerHeight(),o>=0&&s<i&&e.push({font:n.data("font_name"),type:n.data("font_type")})}),void this._loadFonts(e)):null},_toggleFontList:function(t){var e;t?(this.wrapper.css({"z-index":999999}),this.fontList.show(),this._loadVisibleFonts(),e=this.fontList.find("li.selected"),e.length&&this.fontList.scrollTop(e.position().top)):(this.wrapper.css({"z-index":"auto"}),this.fontList.hide())},_bindHandlers:function(){var t,e,n;n=this,t=null,$("html").bind("click.webfont",function(t){n._toggleFontList(!1)}),e=function(t){n._toggleFontList(!0),t.stopPropagation()},this.element.bind("click.webfont",e),this.toggle.bind("click.webfont",e),this.fontList.bind("scroll.webfont",function(e){window.clearTimeout(t),t=window.setTimeout(function(){n._loadVisibleFonts()},250)}).bind("click.webfont",function(t){var e;return e=$(t.target),e.is("li")?void n._selectFontListItem(e):null})},destory:function(){this.fontList.remove(),this.toggle.remove(),this.element.removeClass("webfont-input").removeAttr("readonly").unbind("click.webfont").unwrap(),$("html").unbind("click.webfont"),$.Widget.prototype.destory.call(this)}})}(jQuery);
//# sourceMappingURL=./webfont.select.js.map